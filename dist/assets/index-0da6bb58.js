import{aG as ae,b as R,d as W,m as oe,i as ne,u as D,_ as O,j as le,E as ce,w as ie,B as de,ar as re,D as F,a5 as A,b7 as j,Q as J,a7 as ue,O as _e,I as pe,a6 as me,b8 as ve}from"./index-1285a334.js";import{U as Q,C as X,d as M,_ as U,E as Y,e as fe}from"./useCached-4f487c00.js";import{r as S,w as ye,y as ge,v as y,z as h,k as i,l as u,A as L,F as E,u as t,J as N,D as b,B as he,ax as Ce,T as be,t as $e,m as f,a2 as T,G as w,C as m,ay as ke,P as xe,E as V,H as we,ad as Z,O as K,a5 as z,L as P,af as Ie}from"./vue-656d1634.js";import{E as Ee}from"./el-divider-060423de.js";import{E as Se}from"./index-cecbf38c.js";import"./xgplayer-9c9652e6.js";function q(){if(!arguments.length)return[];var a=arguments[0];return ae(a)?a:[a]}const ee=()=>Math.floor(Math.random()*1e4),G=a=>typeof ne(a),Te=R({accordion:Boolean,modelValue:{type:W([Array,String,Number]),default:()=>oe([])}}),Be={[Q]:G,[X]:G},te=Symbol("collapseContextKey"),Ne=(a,o)=>{const s=S(q(a.modelValue)),l=n=>{s.value=n;const c=a.accordion?s.value[0]:s.value;o(Q,c),o(X,c)},e=n=>{if(a.accordion)l([s.value[0]===n?"":n]);else{const c=[...s.value],d=c.indexOf(n);d>-1?c.splice(d,1):c.push(n),l(c)}};return ye(()=>a.modelValue,()=>s.value=q(a.modelValue),{deep:!0}),ge(te,{activeNames:s,handleItemClick:e}),{activeNames:s,setActiveNames:l}},Fe=()=>{const a=D("collapse");return{rootKls:y(()=>a.b())}},He=h({name:"ElCollapse"}),Le=h({...He,props:Te,emits:Be,setup(a,{expose:o,emit:s}){const l=a,{activeNames:e,setActiveNames:n}=Ne(l,s),{rootKls:c}=Fe();return o({activeNames:e,setActiveNames:n}),(d,g)=>(i(),u("div",{class:E(t(c))},[L(d.$slots,"default")],2))}});var Ke=O(Le,[["__file","/home/runner/work/element-plus/element-plus/packages/components/collapse/src/collapse.vue"]]);const Pe=h({name:"ElCollapseTransition"}),Ae=h({...Pe,setup(a){const o=D("collapse-transition"),s=e=>{e.style.maxHeight="",e.style.overflow=e.dataset.oldOverflow,e.style.paddingTop=e.dataset.oldPaddingTop,e.style.paddingBottom=e.dataset.oldPaddingBottom},l={beforeEnter(e){e.dataset||(e.dataset={}),e.dataset.oldPaddingTop=e.style.paddingTop,e.dataset.oldPaddingBottom=e.style.paddingBottom,e.style.maxHeight=0,e.style.paddingTop=0,e.style.paddingBottom=0},enter(e){e.dataset.oldOverflow=e.style.overflow,e.scrollHeight!==0?e.style.maxHeight=`${e.scrollHeight}px`:e.style.maxHeight=0,e.style.paddingTop=e.dataset.oldPaddingTop,e.style.paddingBottom=e.dataset.oldPaddingBottom,e.style.overflow="hidden"},afterEnter(e){e.style.maxHeight="",e.style.overflow=e.dataset.oldOverflow},enterCancelled(e){s(e)},beforeLeave(e){e.dataset||(e.dataset={}),e.dataset.oldPaddingTop=e.style.paddingTop,e.dataset.oldPaddingBottom=e.style.paddingBottom,e.dataset.oldOverflow=e.style.overflow,e.style.maxHeight=`${e.scrollHeight}px`,e.style.overflow="hidden"},leave(e){e.scrollHeight!==0&&(e.style.maxHeight=0,e.style.paddingTop=0,e.style.paddingBottom=0)},afterLeave(e){s(e)},leaveCancelled(e){s(e)}};return(e,n)=>(i(),N(be,he({name:t(o).b()},Ce(l)),{default:b(()=>[L(e.$slots,"default")]),_:3},16,["name"]))}});var H=O(Ae,[["__file","/home/runner/work/element-plus/element-plus/packages/components/collapse-transition/src/collapse-transition.vue"]]);H.install=a=>{a.component(H.name,H)};const Ve=H,De=R({title:{type:String,default:""},name:{type:W([String,Number]),default:()=>ee()},disabled:Boolean}),Oe=a=>{const o=$e(te),s=S(!1),l=S(!1),e=S(ee()),n=y(()=>o==null?void 0:o.activeNames.value.includes(a.name));return{focusing:s,id:e,isActive:n,handleFocus:()=>{setTimeout(()=>{l.value?l.value=!1:s.value=!0},50)},handleHeaderClick:()=>{a.disabled||(o==null||o.handleItemClick(a.name),s.value=!1,l.value=!0)},handleEnterClick:()=>{o==null||o.handleItemClick(a.name)}}},Me=(a,{focusing:o,isActive:s,id:l})=>{const e=D("collapse"),n=y(()=>[e.b("item"),e.is("active",t(s)),e.is("disabled",a.disabled)]),c=y(()=>[e.be("item","header"),e.is("active",t(s)),{focusing:t(o)&&!a.disabled}]),d=y(()=>[e.be("item","arrow"),e.is("active",t(s))]),g=y(()=>e.be("item","wrap")),C=y(()=>e.be("item","content")),r=y(()=>e.b(`content-${t(l)}`)),_=y(()=>e.b(`head-${t(l)}`));return{arrowKls:d,headKls:c,rootKls:n,itemWrapperKls:g,itemContentKls:C,scopedContentId:r,scopedHeadId:_}},Ue=["id","aria-expanded","aria-controls","aria-describedby","tabindex"],ze=["id","aria-hidden","aria-labelledby"],qe=h({name:"ElCollapseItem"}),Ge=h({...qe,props:De,setup(a,{expose:o}){const s=a,{focusing:l,id:e,isActive:n,handleFocus:c,handleHeaderClick:d,handleEnterClick:g}=Oe(s),{arrowKls:C,headKls:r,rootKls:_,itemWrapperKls:B,itemContentKls:I,scopedContentId:$,scopedHeadId:k}=Me(s,{focusing:l,isActive:n,id:e});return o({isActive:n}),(v,p)=>(i(),u("div",{class:E(t(_))},[f("button",{id:t(k),class:E(t(r)),"aria-expanded":t(n),"aria-controls":t($),"aria-describedby":t($),tabindex:v.disabled?-1:0,onClick:p[0]||(p[0]=(...x)=>t(d)&&t(d)(...x)),onKeydown:p[1]||(p[1]=ke(xe((...x)=>t(g)&&t(g)(...x),["stop","prevent"]),["space","enter"])),onFocus:p[2]||(p[2]=(...x)=>t(c)&&t(c)(...x)),onBlur:p[3]||(p[3]=x=>l.value=!1)},[L(v.$slots,"title",{},()=>[T(w(v.title),1)]),m(t(ce),{class:E(t(C))},{default:b(()=>[m(t(le))]),_:1},8,["class"])],42,Ue),m(t(Ve),null,{default:b(()=>[V(f("div",{id:t($),role:"region",class:E(t(B)),"aria-hidden":!t(n),"aria-labelledby":t(k)},[f("div",{class:E(t(I))},[L(v.$slots,"default")],2)],10,ze),[[we,t(n)]])]),_:3})],2))}});var se=O(Ge,[["__file","/home/runner/work/element-plus/element-plus/packages/components/collapse/src/collapse-item.vue"]]);const Re=ie(Ke,{CollapseItem:se}),We=de(se);const je={class:"item-info contact-item"},Je={class:"item-info-right"},Qe={class:"item-info-name"},Xe=h({__name:"ContactItem",props:{item:{}},setup(a){const o=a,{item:s}=Z(o),l=y(()=>{var n;return(n=s==null?void 0:s.value)==null?void 0:n.uid}),e=M(l.value);return(n,c)=>{const d=U;return i(),u("div",je,[m(d,{class:"avatar",src:t(e).avatar,size:40,showStatus:"",online:t(s).activeStatus===t(re).ONLINE},null,8,["src","online"]),f("div",Je,[f("span",Qe,w(t(e).name),1)])])}}});const Ye=F(Xe,[["__scopeId","data-v-ad7351de"]]),Ze={class:"item-info"},et={class:"item-info-right"},tt={class:"item-info-name"},st={key:1,class:"item-info-accept-text"},at={class:"item-info-msg"},ot=h({__name:"NewFriendItem",props:{item:{}},setup(a){const o=a,{item:s}=Z(o),l=A(),e=y(()=>{var c;return(c=s==null?void 0:s.value)==null?void 0:c.uid}),n=M(e.value);return(c,d)=>{var C;const g=U;return i(),u("div",Ze,[m(g,{class:"avatar",src:t(n).avatar,size:40},null,8,["src"]),f("div",et,[f("span",tt,[T(w(t(n).name)+" ",1),t(s).status===t(j).Waiting?(i(),u("button",{key:0,class:"item-info-accept-btn",onClick:d[0]||(d[0]=r=>t(l).onAcceptFriend(t(s).applyId))}," 接受 ")):(i(),u("span",st,"已添加"))]),f("span",at,w((C=t(s))==null?void 0:C.msg),1)])])}}});const nt=F(ot,[["__scopeId","data-v-80611785"]]),lt={class:"side"},ct=["infinite-scroll-disabled"],it={key:0,class:"read-unread-no-data"},dt=["infinite-scroll-disabled"],rt={key:0,class:"read-unread-no-data"},ut=h({__name:"index",setup(a){const o=A(),s=J(),l=S("1"),e=S(!0),n=r=>{s.currentSelectedContact=r},c=()=>{o.getRequestFriendsList()},d=()=>{o.getContactList()},g=()=>{e.value=!0,setTimeout(()=>{e.value=!1},500)},C=()=>{s.createGroupModalInfo.show=!0};return(r,_)=>{const B=Y,I=We,$=Re,k=fe;return i(),u("div",lt,[m(B,{class:"add-group",type:"primary",size:"small",onClick:C},{default:b(()=>[T("创建群聊")]),_:1}),m($,{class:"side-collapse",modelValue:l.value,"onUpdate:modelValue":_[0]||(_[0]=v=>l.value=v),onChange:g,accordion:""},{default:b(()=>[m(I,{title:"新的朋友",name:"1"},{default:b(()=>{var v;return[V((i(),u("ul",{"infinite-scroll-disabled":e.value,class:"read-unread-list"},[(i(!0),u(K,null,z(t(o).requestFriendsList,p=>(i(),N(nt,{key:p.uid,item:p,onClick:x=>n(p)},null,8,["item","onClick"]))),128)),((v=t(o).requestFriendsList)==null?void 0:v.length)===0?(i(),u("li",it," 暂无数据~ ")):P("",!0)],8,ct)),[[k,c]])]}),_:1}),m(I,{title:"联系人",name:"2"},{default:b(()=>{var v;return[V((i(),u("ul",{"infinite-scroll-disabled":e.value,class:"read-unread-list"},[(i(!0),u(K,null,z(t(o).contactsList,p=>(i(),N(Ye,{key:p.uid,item:p,onClick:x=>n(p)},null,8,["item","onClick"]))),128)),((v=t(o).contactsList)==null?void 0:v.length)===0?(i(),u("li",rt," 暂无数据~ ")):P("",!0)],8,dt)),[[k,d]])]}),_:1})]),_:1},8,["modelValue"])])}}});const _t=F(ut,[["__scopeId","data-v-3ab1ed3c"]]),pt={class:"contact-content"},mt={key:0,class:"contact-main"},vt={class:"contact-info-wrapper"},ft={class:"contact-info"},yt={class:"contact-info-name"},gt={class:"contact-info-uid"},ht={class:"contact-info-place"},Ct={class:"contact-request-msg"},bt={class:"contact-info-buttons"},$t=h({__name:"index",setup(a){const o=A(),s=ue(),l=J(),e=y(()=>l.currentSelectedContact),n=y(()=>{var r;return(r=e==null?void 0:e.value)==null?void 0:r.uid}),c=y(()=>{var r;return((r=e.value)==null?void 0:r.status)===j.Waiting}),d=M(n),g=r=>{Se.confirm("确认删除该联系人?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{await o.onDeleteContact(r),_e.success("删除成功!")}).catch(()=>{})},C=async r=>{const _=await pe.sessionDetailWithFriends({uid:r}).send();l.currentSession.roomId=_.roomId,l.currentSession.type=me.Single,s.updateSessionLastActiveTime(_.roomId,_),ve.push("/")};return(r,_)=>{var k;const B=U,I=Ee,$=Y;return i(),u("div",pt,[n.value?(i(),u("div",mt,[f("div",vt,[m(B,{class:"avatar",src:t(d).avatar,size:70},null,8,["src"]),f("div",ft,[f("span",yt,w(t(d).name),1),f("span",gt," uid: "+w(t(d).uid),1),f("span",ht," 地区: "+w(t(d).locPlace||"-"),1)])]),m(I),c.value&&((k=e.value)!=null&&k.msg)?(i(),u(K,{key:0},[f("div",Ct," Ta说: "+w(e.value.msg),1),m(I)],64)):P("",!0),f("div",bt,[c.value?(i(),N($,{key:0,type:"success",onClick:_[0]||(_[0]=v=>t(o).onAcceptFriend(e.value.applyId))},{default:b(()=>[T("接受")]),_:1})):(i(),u(K,{key:1},[m($,{type:"primary",onClick:_[1]||(_[1]=v=>C(e.value.uid))},{default:b(()=>[T("发消息")]),_:1}),m($,{type:"danger",onClick:_[2]||(_[2]=v=>g(e.value.uid))},{default:b(()=>[T(" 删除联系人 ")]),_:1})],64))])])):P("",!0)])}}});const kt=F($t,[["__scopeId","data-v-211780af"]]),xt={class:"contact-page"},wt=h({__name:"index",setup(a){return(o,s)=>(i(),u("div",xt,[m(_t),m(kt)]))}});const It=F(wt,[["__scopeId","data-v-4898f993"]]),Ht=h({__name:"index",setup(a){const o=A();return Ie(()=>{o.getContactList(!0),o.getRequestFriendsList(!0)}),(s,l)=>(i(),N(It))}});export{Ht as default};
